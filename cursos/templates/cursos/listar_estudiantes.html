{% extends 'base.html' %}

{% block title %}Listar Estudiantes{% endblock %}

{% block content %}
<div class="container mt-5">
    <h2 class="text-center mb-4">Listar Estudiantes por Curso</h2>
    <div class="accordion" id="accordionCursos">
        {% for curso_info in cursos_con_estudiantes %}
            <div class="card">
                <div class="card-header" id="heading{{ curso_info.curso.id }}">
                    <h2 class="mb-0">
                        <button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse{{ curso_info.curso.id }}" aria-expanded="true" aria-controls="collapse{{ curso_info.curso.id }}">
                            {{ curso_info.curso.nombre }} ({{ curso_info.total }} estudiantes)
                        </button>
                        <a href="{% url 'exportar_estudiantes_excel' curso_info.curso.id %}" class="btn btn-success float-right">Exportar a Excel</a>
                    </h2>
                </div>

                <div id="collapse{{ curso_info.curso.id }}" class="collapse" aria-labelledby="heading{{ curso_info.curso.id }}" data-parent="#accordionCursos">
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-striped table-bordered">
                                <thead class="thead-dark">
                                    <tr>
                                        <th>RPE</th>
                                        <th>Nombre</th>
                                        <th>Apellido Paterno</th>
                                        <th>Apellido Materno</th>
                                        <th>Correo</th>
                                        <th>Teléfono</th>
                                        <th>Área de Trabajo</th>
                                        <th>Tipo de Empleado</th>
                                        <th>Fecha de Antigüedad</th>
                                        <th>Descripción de Categoría</th>
                                        <th>Área de Adscripción</th>
                                        <th>Descripción Categoría</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for estudiante in curso_info.estudiantes %}
                                        <tr>
                                            <td>{{ estudiante.rpe }}</td>
                                            <td>{{ estudiante.nombre }}</td>
                                            <td>{{ estudiante.apellido_paterno }}</td>
                                            <td>{{ estudiante.apellido_materno }}</td>
                                            <td>{{ estudiante.correo }}</td>
                                            <td>{{ estudiante.telefono }}</td>
                                            <td>{{ estudiante.area_trabajo }}</td>
                                            <td>{{ estudiante.tc }}</td>
                                            <td>{{ estudiante.fecha_antiguedad }}</td>
                                            <td>{{ estudiante.categoria_descripcion }}</td>
                                            <td>{{ estudiante.area_adscripcion }}</td>
                                            <td>{{ estudiante.descripcion_categoria }}</td>
                                        </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        {% endfor %}
    </div>
</div>
{% endblock %}
